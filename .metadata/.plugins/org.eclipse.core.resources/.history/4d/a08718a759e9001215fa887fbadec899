package  {
	
	import com.greensock.TweenLite;
	import com.greensock.layout.AlignMode;
	import com.greensock.layout.AutoFitArea;
	import com.greensock.layout.ScaleMode;
	
	import effect.EffectPerson;
	import effect.FlashButton;
	
	import flash.display.MovieClip;
	import flash.events.Event;
	import flash.events.MouseEvent;
	import flash.filters.GlowFilter;
	import flash.system.Capabilities;
	
	
	public class CareerContent extends MovieClip {
		
		/**
		 *人 logo
		 */		
		public var personLogo:MovieClip;
		/**
		 *兽 logo
		 */		
		public var orcLogo:MovieClip;
		/**
		 *亡灵 logo
		 */		
		public var ghostLogo:MovieClip;
		
		private var personLogoBtn:FlashButton;
		private var orcLogoBtn:FlashButton;
		private var ghostLogoBtn:FlashButton;
		
		private var effectPerson:EffectPerson;
		private var effectOrc:EffectPerson;
		private var effectGhost:EffectPerson;
		
		private var btnArr:Vector.<FlashButton>
		private var careerArr:Vector.<EffectPerson>;
		
		private var fitArea:AutoFitArea;
		
		public var personDes:MovieClip;
		public var ghostDes:MovieClip;
		public var orcDes:MovieClip;
		private var desArr:Vector.<MovieClip>;
		public var pContainerMc:MovieClip;
		
		public var midPersonArr:Array = [{"orc":{'x':0,'y':95,"scale":0.7}},{"person":{'x':374,'y':0,"scale":1}},{"ghost":{'x':665,'y':85,"scale":0.7}}];
		public var midOrcArr:Array = [{"orc":{'x':140,'y':0,"scale":1}},{"person":{'x':0,'y':319,"scale":0.7}},{"ghost":{'x':817,'y':215,"scale":0.7}}];
		public var midGhostArr:Array = [{"orc":{'x':0,'y':236,"scale":0.7}},{"person":{'x':826,'y':322,"scale":0.7}},{"ghost":{'x':172,'y':0,"scale":1}}];
		
		public function CareerContent() {
			
			
			//=====================================
			effectPerson = new EffectPerson(pContainerMc.personMc);
			addChild(effectPerson);
			effectOrc = new EffectPerson(pContainerMc.orcMc);
			addChild(effectOrc)
			effectGhost = new EffectPerson(pContainerMc.ghostMc);
			addChild(effectGhost);
			//=====================================================
			personLogoBtn = new FlashButton(personLogo);
			personLogoBtn.index = 0;
			addChild(personLogoBtn);
			
			orcLogoBtn = new FlashButton(orcLogo);
			orcLogoBtn.index = 1;
			addChild(orcLogoBtn);
			
			ghostLogoBtn = new FlashButton(ghostLogo);
			ghostLogoBtn.index = 2;
			addChild(ghostLogoBtn);
			
			addChild(pContainerMc);
			personLogoBtn.addEventListener(MouseEvent.CLICK,clickHandler);
			orcLogoBtn.addEventListener(MouseEvent.CLICK,clickHandler);
			ghostLogoBtn.addEventListener(MouseEvent.CLICK,clickHandler);
			
			btnArr = new Vector.<FlashButton>();
			btnArr.push(personLogoBtn);
			btnArr.push(orcLogoBtn);
			btnArr.push(ghostLogoBtn);
			//=================================================

			careerArr = new Vector.<EffectPerson>;
			careerArr.push(effectPerson);
			careerArr.push(effectOrc);
			careerArr.push(effectGhost);
			
			//effectPerson.x = effectOrc.x = effectGhost.x = 0;
			//effectPerson.y = effectOrc.y = effectGhost.y = 0;
			pContainerMc.addChild(effectPerson);
			pContainerMc.addChild(effectOrc);
			effectOrc.x = effectPerson.width;
			pContainerMc.addChild(effectGhost);
			effectGhost.x = effectOrc.width+effectPerson.width;
			//===========================================
			desArr = new Vector.<MovieClip>();
			desArr.push(personDes);
			desArr.push(orcDes);
			desArr.push(ghostDes);
			
			addEventListener(Event.ADDED_TO_STAGE,addToStageHandler);
		}
		
		protected function clickHandler(evt:MouseEvent):void
		{
			var index:int = FlashButton(evt.currentTarget).index;
			setSelctBtnIndex(index);			
		}
		
		protected function addToStageHandler(event:Event):void
		{
			layout();
			initElements();
			
		}
		/**
		 * 初始元素
		 * 默认 是人
		 */		
		private function initElements():void{
				
			setSelctBtnIndex(0);
		}
		private function setSelctBtnIndex(index:int):void{
			for (var i:int = 0; i < 3; i++) 
			{
				if(btnArr[i].index == index){
					btnArr[i].startEffect();
					btnArr[i].enabled = false;
					
					var p:EffectPerson = careerArr[i];
					careerArr.splice(i,1);
					careerArr.unshift(p);
					playCareer(index);
					TweenLite.to(desArr[i],.4,{alpha:1,y:btnArr[1].y});
				}else{
					btnArr[i].destroy();
					btnArr[i].enabled = true;
					TweenLite.to(desArr[i],.2,{alpha:0,y:-161});
				}
			}
			//pContainerMc.x = (Capabilities.screenResolutionX-pContainerMc.width)/2;
		}
		/**
		 * 
		 * @param index	
		 *0人
		 *1兽
		 *2亡灵 
		 * 
		 */		
		private function playCareer(index:int):void{
			var arr:Array = [];
			switch(index)
			{
				case 0:
					arr = midPersonArr;
					break;
				case 1:
					arr = midOrcArr;
					break;
				case 2:
					arr = midGhostArr;
					break;

			}
			TweenLite.to();
			for (var i:int = 0; i < 3; i++) 
			{
				
				TweenLite.to(careerArr[i],0.5,{x:this['posArr'+index][i].x,y:this['posArr'+index][i].y,scaleX:scaleArr[i],scaleY:scaleArr[i]});
				careerArr[i].show(careerGray[i]);
			}
			pContainerMc.setChildIndex(careerArr[0],pContainerMc.numChildren - 1);
		}
		private function layout():void{
			//fitArea = new AutoFitArea(this, 0, 0, Capabilities.screenResolutionX, Capabilities.screenResolutionY);
			//fitArea.attach(this["bg"], {crop:true, scaleMode:ScaleMode.PROPORTIONAL_OUTSIDE, hAlign:AlignMode.CENTER, vAlign:AlignMode.TOP, roundPosition:true, minWidth:Consts.MIN_WIDTH, maxWidth:Consts.MAX_WIDTH, minHeight:Consts.MIN_HEIGHT, maxHeight:Consts.MAX_HEIGHT});			
			
			pContainerMc.x = 250//(Capabilities.screenResolutionX-pContainerMc.width)/2;
			//按钮位置
			for (var i:int = 0; i < 3; i++) 
			{
				btnArr[i].x = 200;
				btnArr[i].y = 100+(btnArr[i].height+30)*i;
			}
			//TweenLite.to(careerContainer,0.5,{x:300,onComplete:function():void{playCareer(0)}})
		} 
	}
	
}
